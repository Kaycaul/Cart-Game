[gd_scene load_steps=22 format=2]

[ext_resource path="res://Scenes/ObstaclePlacer.tscn" type="PackedScene" id=1]
[ext_resource path="res://Scenes/PathDrawer.tscn" type="PackedScene" id=2]
[ext_resource path="res://Scenes/CoinPlacer.tscn" type="PackedScene" id=3]
[ext_resource path="res://Scenes/HUD.tscn" type="PackedScene" id=4]
[ext_resource path="res://Scripts/EndOfLevelArea2D.gd" type="Script" id=5]
[ext_resource path="res://Scripts/Player.gd" type="Script" id=6]
[ext_resource path="res://assets/cart.png" type="Texture" id=7]
[ext_resource path="res://assets/explosion.wav" type="AudioStream" id=8]
[ext_resource path="res://assets/karleton tunnel adventure2.png" type="Texture" id=9]
[ext_resource path="res://assets/pickupCoin.wav" type="AudioStream" id=10]
[ext_resource path="res://assets/nice with jazz.mp3" type="AudioStream" id=11]
[ext_resource path="res://Scenes/zoom_in.tres" type="Curve" id=12]
[ext_resource path="res://Scenes/Obstacles/Obstacle.tscn" type="PackedScene" id=13]
[ext_resource path="res://Scenes/Obstacles/CartObstacle.tscn" type="PackedScene" id=14]
[ext_resource path="res://Scenes/Floor.tscn" type="PackedScene" id=15]

[sub_resource type="Curve2D" id=1]
_data = {
"points": PoolVector2Array( 0, 0, 0, 0, 2089, -2445, 0, 0, 0, 0, 2554, -2079, -2, -13.5, 2, 13.5, 2570, -2059, 0, 0, 0, 0, 2559, -2035, 0, 0, 0, 0, 1572, -619, 6.13518, -18.4055, -6.13518, 18.4055, 1547, -576, 0, 0, 0, 0, 1544, -521, 0, 0, 0, 0, 1550, -4, -12.7423, -14.6301, 12.7423, 14.6301, 1564, 40, 0, 0, 0, 0, 1580, 57, 0, 0, 0, 0, 2007, 432, -16.5178, -0.471937, 16.5178, 0.471937, 2045, 456, 0, 0, 0, 0, 2076, 457, 0, 0, 0, 0, 2565, 455, -11.7984, -10.8546, 11.7984, 10.8546, 2626, 462, 0, 0, 0, 0, 2634, 516, 0, 0, 0, 0, 2661, 1567, 13.6862, -16.5178, -13.6862, 16.5178, 2654, 1631, 0, 0, 0, 0, 2585, 1644, 0, 0, 0, 0, 2280, 1656, 25.0127, -21.2372, -25.0127, 21.2372, 2209, 1673, 0, 0, 0, 0, 2170, 1708, 0, 0, 0, 0, 1987, 1870, 8.02293, -15.5739, -8.02293, 15.5739, 1947, 1909, 0, 0, 0, 0, 1942, 1970, 0, 0, 0, 0, 1939, 2233, 10.8546, -14.1581, -10.8546, 14.1581, 1933, 2278, 0, 0, 0, 0, 1883, 2288, 143.469, 1.41581, -143.469, -1.41581, 1326, 2274, 6.60712, 49.0815, -6.60712, -49.0815, 1138, 2155, -121.288, -7.07906, 121.288, 7.07906, 1347, 2049, 3.30356, -37.283, -3.30356, 37.283, 1519, 2145, 141.109, 3.7755, -141.109, -3.7755, 1335, 2274, 0, 0, 0, 0, 1128, 2268, 0, 0, 0, 0, -233, 2265, 25.8361, -26.727, -25.8361, 26.727, -338, 2288, 0, 0, 0, 0, -375, 2327, 0, 0, 0, 0, -636, 2630 )
}

[sub_resource type="Curve" id=4]
min_value = 0.25
max_value = 0.55
_data = [ Vector2( 0, 0.25 ), 0.0, 0.0, 0, 0, Vector2( 0.333333, 0.281818 ), 0.279379, 0.279379, 0, 0, Vector2( 1, 0.506364 ), 0.0636364, 0.0, 0, 0 ]

[sub_resource type="RectangleShape2D" id=2]
extents = Vector2( 12.1401, 17.8391 )

[sub_resource type="Animation" id=3]
resource_name = "skid"
length = 1.3
tracks/0/type = "value"
tracks/0/path = NodePath("Player1:rotation_degrees")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1, 1.1, 1.2 ),
"transitions": PoolRealArray( 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 ),
"update": 0,
"values": [ 90.0002, 100.0, 110.0, 120.0, 110.0, 100.0, 90.0, 80.0, 70.0, 60.0, 70.0, 80.0, 90.0 ]
}

[sub_resource type="GDScript" id=6]
script/source = "extends PathFollow2D

onready var parent_path = get_parent()

export (PackedScene) var path_part

# spawns a path part everywhere on the path
func _ready():
	var i = 0
	for point in parent_path.curve.get_baked_length():
		# move along the path to the given position
		set_offset(i)
		var obstacle = path_part.instance()
		# spawn the obstacle, but dont parent it to this
		get_node(\"/root\").call_deferred(\"add_child\", obstacle) # error handler told me to use call_deferred, fixed everything, idk why
		obstacle.position = position
		obstacle.rotation = rotation
		obstacle.z_index = -1
		i += parent_path.curve.bake_interval * 5
"

[sub_resource type="RectangleShape2D" id=5]
extents = Vector2( 54.7087, 48.5215 )

[node name="Root3" type="Node"]

[node name="Scenery" type="Node2D" parent="."]
position = Vector2( 77, 207 )

[node name="Background" type="Sprite" parent="Scenery"]
scale = Vector2( 1.5, 1.5 )
z_index = -2
texture = ExtResource( 9 )
__meta__ = {
"_edit_lock_": true
}

[node name="PlayerPath" type="Path2D" parent="."]
curve = SubResource( 1 )
__meta__ = {
"_edit_lock_": true
}

[node name="PlayerPathFollow" type="PathFollow2D" parent="PlayerPath"]
position = Vector2( 2089, -2445 )
rotation = 0.666838

[node name="PlayerObject" type="Area2D" parent="PlayerPath/PlayerPathFollow"]
script = ExtResource( 6 )
__meta__ = {
"_edit_group_": true
}
accel = 0.26
zoom_curve = SubResource( 4 )
intro_zoom_curve = ExtResource( 12 )
MAX_SPEED = 500
DEFAULT_SPEED = 70
CRASH_FORCE = 165

[node name="Player1" type="Sprite" parent="PlayerPath/PlayerPathFollow/PlayerObject"]
position = Vector2( 1.8924, -0.647064 )
rotation = 1.5708
scale = Vector2( 0.4, 0.4 )
texture = ExtResource( 7 )

[node name="CollisionShape2D" type="CollisionShape2D" parent="PlayerPath/PlayerPathFollow/PlayerObject"]
position = Vector2( 1.98328, -0.752075 )
rotation = 1.57036
scale = Vector2( 0.4, 0.4 )
shape = SubResource( 2 )

[node name="RemoteCartCamera" type="RemoteTransform2D" parent="PlayerPath/PlayerPathFollow/PlayerObject"]
position = Vector2( 66.623, -2.26453 )
rotation = 1.5708
scale = Vector2( 0.4, 0.4 )
remote_path = NodePath("../CartCamera")

[node name="AnimationPlayer" type="AnimationPlayer" parent="PlayerPath/PlayerPathFollow/PlayerObject"]
anims/skid = SubResource( 3 )

[node name="CartCamera" type="Camera2D" parent="PlayerPath/PlayerPathFollow/PlayerObject"]
position = Vector2( 66.623, -2.26465 )
rotation = 1.5708
scale = Vector2( 0.4, 0.4 )
rotating = true
current = true
zoom = Vector2( 0.25, 0.25 )
limit_smoothed = true

[node name="CollisionEffect" type="AudioStreamPlayer" parent="PlayerPath/PlayerPathFollow/PlayerObject"]
stream = ExtResource( 8 )
volume_db = -40.0

[node name="pickupCoin1" type="AudioStreamPlayer" parent="PlayerPath/PlayerPathFollow/PlayerObject"]
stream = ExtResource( 10 )
volume_db = -30.0

[node name="CanvasLayer" type="CanvasLayer" parent="PlayerPath/PlayerPathFollow/PlayerObject"]

[node name="HUD" parent="PlayerPath/PlayerPathFollow/PlayerObject/CanvasLayer" instance=ExtResource( 4 )]

[node name="ObstaclePlacer" parent="PlayerPath" instance=ExtResource( 1 )]
position = Vector2( 936.613, 2267.58 )
rotation = -3.13937
obstacles_to_spawn = [ ExtResource( 14 ), ExtResource( 13 ) ]
obstacle_count = 100
spawner_seed = "among us"

[node name="CoinPlacer" parent="PlayerPath" instance=ExtResource( 3 )]
position = Vector2( 2089, -2445 )
rotation = 0.666838
total_coins = 25
spawner_seed = "hehehe"

[node name="PathDrawer" parent="PlayerPath" instance=ExtResource( 2 )]
script = SubResource( 6 )
path_part = ExtResource( 15 )

[node name="EndOfLevel1Area2D" type="Area2D" parent="."]
script = ExtResource( 5 )
__meta__ = {
"_edit_group_": true
}

[node name="CollisionShape2D" type="CollisionShape2D" parent="EndOfLevel1Area2D"]
position = Vector2( -664.62, 2664.35 )
rotation = -0.87441
shape = SubResource( 5 )

[node name="Background Music" type="AudioStreamPlayer" parent="."]
stream = ExtResource( 11 )
volume_db = -30.0
autoplay = true

[connection signal="area_shape_entered" from="PlayerPath/PlayerPathFollow/PlayerObject" to="PlayerPath/PlayerPathFollow/PlayerObject" method="_on_PlayerObject_area_shape_entered"]
[connection signal="area_shape_entered" from="EndOfLevel1Area2D" to="EndOfLevel1Area2D" method="_on_EndOfLevel1Area2D_area_shape_entered"]
